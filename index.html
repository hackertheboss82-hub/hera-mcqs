<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hera MCQs</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f1f5ff;
  margin:0;
}

.container{
  max-width:900px;
  margin:auto;
  padding:15px;
}

.card{
  background:#ffffff;
  padding:20px;
  border-radius:14px;
  margin-bottom:25px;
  border:2px solid #dbe4ff;
  box-shadow:0 10px 25px rgba(0,0,0,0.08);
}

h2,h3{
  text-align:center;
  color:#1e40af;
}

input, textarea, select, button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #c7d2fe;
  font-size:15px;
}

button{
  background:#2d5be3;
  color:white;
  border:none;
  cursor:pointer;
  font-weight:600;
}

button:hover{background:#1e40af}

.hidden{display:none}

.palette{
  padding:10px;
  border:1px dashed #c7d2fe;
  border-radius:10px;
  margin-bottom:15px;
  background:#f8faff;
  text-align:center;
}

.palette span{
  display:inline-block;
  width:36px;
  height:36px;
  line-height:36px;
  margin:4px;
  border-radius:50%;
  background:#e0e7ff;
  cursor:pointer;
  font-weight:600;
}

.palette .done{
  background:#2d5be3;
  color:white;
}

.options label{
  display:block;
  padding:12px;
  border:1px solid #c7d2fe;
  margin:8px 0;
  border-radius:10px;
  cursor:pointer;
  background:#f8faff;
}

.options label:hover{
  background:#eef2ff;
}

.nav{
  display:flex;
  gap:10px;
  margin-top:15px;
}

@media(max-width:600px){
  .nav{flex-direction:column;}
}
</style>
</head>

<body>
<div class="container">

<h2>üìò Hera MCQs Examination</h2>

<!-- TEACHER PANEL -->
<div class="card">
<h3>üë©‚Äçüè´ Teacher Panel</h3>

<input id="testTitle" placeholder="Test Title">

<textarea id="qText" placeholder="Question"></textarea>
<input id="o1" placeholder="Option A">
<input id="o2" placeholder="Option B">
<input id="o3" placeholder="Option C">
<input id="o4" placeholder="Option D">

<select id="correct">
  <option value="0">Correct: A</option>
  <option value="1">Correct: B</option>
  <option value="2">Correct: C</option>
  <option value="3">Correct: D</option>
</select>

<button onclick="addQuestion()">Add Question</button>
<button onclick="saveTest()">Save Test</button>

<div id="teacherList"></div>
</div>

<!-- STUDENT PANEL -->
<div class="card">
<h3>üßë‚Äçüéì Student Exam Mode</h3>

<button onclick="startExam()">Start Exam</button>

<div id="exam" class="hidden">

<div class="palette" id="palette"></div>

<h3 id="qNo"></h3>
<p id="question"></p>

<div class="options" id="options"></div>

<div class="nav">
<button onclick="prevQ()">Previous</button>
<button id="nextBtn" onclick="nextQ()">Next</button>
<button onclick="submitExam()">Submit</button>
</div>

</div>
</div>

</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyChhkiu5e6fKVowh2RRvkegVdTwn7yV8Zc",
  authDomain: "hera-mcqs.firebaseapp.com",
  projectId: "hera-mcqs",
  storageBucket: "hera-mcqs.firebasestorage.app",
  messagingSenderId: "284002289050",
  appId: "1:284002289050:web:e98f219b72f5c7cc3c6623"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let questions = [];
let examQ = [];
let answers = {};
let index = 0;

/* TEACHER */
function addQuestion(){
  questions.push({
    q:qText.value,
    o:[o1.value,o2.value,o3.value,o4.value],
    c:correct.value
  });
  qText.value=o1.value=o2.value=o3.value=o4.value="";
  loadTeacherList();
}

function loadTeacherList(){
  teacherList.innerHTML="";
  questions.forEach((q,i)=>{
    teacherList.innerHTML+=`<p>${i+1}. ${q.q}</p>`;
  });
}

function saveTest(){
  db.collection("tests").doc("latest").set({questions});
  alert("Test Saved");
}

/* STUDENT */
function startExam(){
  db.collection("tests").doc("latest").get().then(d=>{
    let all=d.data().questions;
    examQ = shuffle(all).slice(0,30);
    index=0;
    answers={};
    document.getElementById("exam").classList.remove("hidden");
    loadQ();
  });
}

function loadQ(){
  let q=examQ[index];
  qNo.innerText=`Question ${index+1} of ${examQ.length}`;
  question.innerText=q.q;

  options.innerHTML="";
  q.o.forEach((op,i)=>{
    options.innerHTML+=`
    <label>
      <input type="radio" name="opt" ${answers[index]==i?"checked":""}
      onclick="answers[${index}]=${i}">
      ${op}
    </label>`;
  });

  updatePalette();

  nextBtn.style.display = (index==examQ.length-1) ? "none":"block";
}

function updatePalette(){
  palette.innerHTML="";
  examQ.forEach((_,i)=>{
    palette.innerHTML+=`<span class="${answers[i]!=null?"done":""}" onclick="jump(${i})">${i+1}</span>`;
  });
}

function jump(i){index=i;loadQ()}
function nextQ(){if(index<examQ.length-1){index++;loadQ()}}
function prevQ(){if(index>0){index--;loadQ()}}

function submitExam(){
  alert("Exam Submitted Successfully");
  document.getElementById("exam").classList.add("hidden");
}

/* UTILS */
function shuffle(a){
  return a.sort(()=>Math.random()-0.5);
}
</script>

</body>
</html>
