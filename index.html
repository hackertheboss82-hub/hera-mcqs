<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MCQ Online Test</title>
<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
header{background:#2563eb;color:#fff;padding:15px;font-size:20px}
.container{max-width:900px;margin:20px auto;background:#fff;padding:20px;border-radius:8px}
button{padding:8px 15px;margin:5px;cursor:pointer}
input,select,textarea{width:100%;padding:8px;margin:5px 0}
textarea{height:180px}
.hidden{display:none}
.question{margin:15px 0}
</style>
</head>

<body>
<header>MCQ Online Test</header>

<div class="container">
<button onclick="showStudent()">Student</button>
<button onclick="showTeacher()">Teacher</button>
</div>

<!-- TEACHER LOGIN -->
<div class="container hidden" id="teacherLogin">
<h3>Teacher Login</h3>
<input type="password" id="teacherPin" placeholder="Enter PIN">
<button onclick="teacherLogin()">Login</button>
</div>

<!-- TEACHER PANEL -->
<div class="container hidden" id="teacherPanel">
<h3>Create / Update Test</h3>

<input id="testName" placeholder="Test Name">
<select id="testClass">
<option>JR</option><option>1</option><option>2</option><option>3</option>
<option>4</option><option>5</option><option>6</option>
<option>7</option><option>8</option><option>9</option><option>10</option>
</select>
<input id="testTime" value="30" placeholder="Time (minutes)">

<p><b>Format:</b><br>
Question | Option1 | Option2 | Option3 | Option4 | correctIndex(0-3)
</p>

<textarea id="questionData"></textarea>
<button onclick="saveTest()">Create / Update Test</button>

<h3>Existing Tests</h3>
<ul id="testList"></ul>
</div>

<!-- STUDENT PANEL -->
<div class="container hidden" id="studentPanel">
<h3>Student Test</h3>
<input id="studentName" placeholder="Student Name">
<select id="studentClass">
<option>JR</option><option>1</option><option>2</option><option>3</option>
<option>4</option><option>5</option><option>6</option>
<option>7</option><option>8</option><option>9</option><option>10</option>
</select>
<button onclick="loadTests()">Load Tests</button>

<div id="testSelect"></div>
<div id="examArea"></div>
</div>

<script>
const PIN = "1914";

/* VIEW SWITCH */
function showTeacher(){
hideAll(); document.getElementById("teacherLogin").classList.remove("hidden");
}
function showStudent(){
hideAll(); document.getElementById("studentPanel").classList.remove("hidden");
}
function hideAll(){
document.querySelectorAll(".container").forEach(d=>d.classList.add("hidden"));
}

/* TEACHER LOGIN */
function teacherLogin(){
if(document.getElementById("teacherPin").value===PIN){
hideAll();
document.getElementById("teacherPanel").classList.remove("hidden");
loadTestList();
}else alert("Wrong PIN");
}

/* SAVE TEST */
function saveTest(){
const name=testName.value.trim();
if(!name){alert("Test name required");return;}

const raw=questionData.value.trim().split("\n");
let questions=[];
for(let i=0;i<raw.length;i++){
let p=raw[i].split("|").map(x=>x.trim());
if(p.length===6){
questions.push({
q:p[0],o:p.slice(1,5),c:parseInt(p[5])
});
}
}
if(questions.length<1){alert("No valid questions");return;}

let tests=JSON.parse(localStorage.getItem("tests")||"{}");
tests[name]={class:testClass.value,time:testTime.value,questions};
localStorage.setItem("tests",JSON.stringify(tests));

alert("Test Saved Successfully");
questionData.value="";
loadTestList();
}

/* LOAD TEST LIST */
function loadTestList(){
let tests=JSON.parse(localStorage.getItem("tests")||"{}");
let ul=document.getElementById("testList");
ul.innerHTML="";
Object.keys(tests).forEach(t=>{
let li=document.createElement("li");
li.innerText=t+" (Class "+tests[t].class+")";
ul.appendChild(li);
});
}

/* STUDENT */
function loadTests(){
let cls=studentClass.value;
let tests=JSON.parse(localStorage.getItem("tests")||"{}");
let div=document.getElementById("testSelect");
div.innerHTML="";
Object.keys(tests).forEach(t=>{
if(tests[t].class===cls){
let b=document.createElement("button");
b.innerText="Start "+t;
b.onclick=()=>startTest(t);
div.appendChild(b);
}
});
}

function startTest(name){
let test=JSON.parse(localStorage.getItem("tests"))[name];
let qs=[...test.questions].sort(()=>0.5-Math.random()).slice(0,30);
let area=document.getElementById("examArea");
area.innerHTML="<h3>"+name+"</h3>";
qs.forEach((q,i)=>{
let d=document.createElement("div");
d.className="question";
d.innerHTML="<b>Q"+(i+1)+". "+q.q+"</b><br>";
q.o.forEach(o=>{
d.innerHTML+=`<label><input type="radio" name="q${i}"> ${o}</label><br>`;
});
area.appendChild(d);
});
}
</script>
</body>
</html>
